<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrunkTrunk | Writer meet Reader - Reader meet Writer</title>
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,900,700,700italic,400italic' rel='stylesheet' type='text/css'>
    <link data--track="true" href="assets/application.css" media="all" rel="stylesheet" />
    <script data-turbolinks-track="true" src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script data-turbolinks-track="true" src="assets/jquery_ujs.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/TrunkForms/Form.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/TrunkForms/InviteForm.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/TrunkForms/ReportForm.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap/transition.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap/alert.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap/button.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap/carousel.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap/collapse.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap/dropdown.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap/modal.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap/tooltip.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap/popover.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap/scrollspy.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap/tab.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap/affix.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/twitter/bootstrap.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/jquery.ui.core.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/jquery.ui.widget.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/jquery.ui.position.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/jquery.ui.menu.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/jquery.ui.autocomplete.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/lib.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/header.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/jquery.showandtell.1.1.1.min.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/jquery.d_modal.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/report.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/jquery.Jcrop.min.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/jquery.cropper.js?body=1"></script>
    <script data-turbolinks-track="true" src="assets/application.js?body=1"></script>
    
    <script src="assets/posts.js?body=1"></script>

    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="tt_editor.js"></script>

  </head>
  <body>
    <div id="top"></div>
    <header class="site-header">
 <nav>
     <a href="http://demo.trunktrunk.org/" id="nav_home" class="pull-left">
         <img src="http://demo.trunktrunk.org/assets/tt_logo_header.png"
              alt="Home"
              class="nav-img"
              title="Home">
     </a>

     <div class="pull-right nav-items">
           <a href="http://demo.trunktrunk.org/posts/new"><span class='nav-label'>create</span> <span class='glyphicon glyphicon-pencil nav-icon'></span></a>
           <a href="http://demo.trunktrunk.org/dashboard"><span class='glyphicon glyphicon-home nav-icon'></span></a>

           <input type="text" placeholder="Search..."
               class="searchbar" id="searchbar">
           <a href="#search" id="nav-search"><span class="glyphicon glyphicon-search nav-icon"></span></a>
       </div>

    </nav>
 </header>
 <article class="edit-article article-view">


<!---- BEGIN EDITOR ---->

<!-- 
    SAVING STATUS
    States: -, modified, saving, saved, publishing, published, not-saved, not-published.
-->
<div class="saving-status"></div>

<!--
    PUBLISH BUTTON
    Clicking this leads to a modal prompting for a potential price, if the
       article has not been published before.
    Here you conforim publishing.
    Upon publishing you are told that you can change the price in the
      settings.
    You are also given a "View published article" link to view the
      published article.
    If the article has already been published, publishing changes happens
      immediately on click.
-->
<div class="publish-button" data-toggle="modal" data-target="#publish-modal"><span class="glyphicon glyphicon-send"></span></div>

<!--
    SETTINGS BUTTON
    Clicking this leads to a settings modal. Settings are:
    - Price
    - Delete
    - Unpublish (if published)
-->
<div class="settings-button" data-toggle="modal" data-target="#settings-modal"><span class="glyphicon glyphicon-cog"></span></div>

<!-- HEADER -->
<header id="header" class="article-header article-category">
    <hgroup class="title">
    <h5>
        <a href='/readers/5'>
          By nt /
          Jun 19, 2014
        </a>
    </h5>
    <h1>no tag</h1>
</hgroup>

<!-- MAIN IMAGE UPLOAD -->
<form accept-charset="UTF-8" action="/post/attach" class="media_form crop_form" enctype="multipart/form-data" id="main_image_form" method="post" style=""><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="sgPUtwEkxRl6LiqzHEwZg5PStTtkvloYdLcxK+sAG5k=" /></div>
        <input id="main_image_form_file" name="post[media]" type="file" />
        <input id="post_type" name="post[type]" type="hidden" value="main_image" />
        <input id="post_prodid" name="post[prodid]" type="hidden" value="14" />

        <img src="http://demo.trunktrunk.org/assets/image_button_article_2x.png" class="main-img trigger" id="main_image">
        <input name="commit" type="submit" value="Update Post" />
</form>    <script>
        $(document).ready(function() {
            $("#main_image_form").submit(function(e) {
                e.preventDefault();
                return false;
            });

            $("#main_image_form_file").trigger_cropping({
                scaleWidth: 960,
                aspectRatio: 16/9
            }, function(img_src) {
                $("#main_image")
                    .attr("src", img_src)
                    .css("opacity", 0.5);

                var media_data = base64_to_blob(img_src);

                var $form = $("#main_image_form");
                var formData = new FormData($form[0]);
                formData.append("post[media]", media_data, "article-main-image");

                $.ajax({
                    url: $form.attr("action"),
                    type: $form.attr("method"),
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function() {
                        $("#main_image").css("opacity", 1);
                    }
                });
            });
        });
    </script>

    <figure>
      <figcaption contenteditable="true" id="main_img_caption" class="form-element edit-field">

      </figcaption>
    </figure>
<!-- END MAIN IMAGE UPLOAD -->
    
<!-- TITLE -->
<textarea type="text" name="title" id="title" class="form-element edit-field" placeholder="Title" value=""></textarea>
<script>
        var $title = $("textarea#title");

        $title.keypress(function(e) {
            if(e.which == 13) {
                e.stopPropagation();
                e.preventDefault();
                return false;
            }
        }).keyup(function(e) {
            $title[0].style.height = '24px';
            $title[0].style.height = $title[0].scrollHeight + 'px';
        });

        $(document).ready(function() {
            $title[0].style.height = '24px';
            $title[0].style.height = $title[0].scrollHeight + 'px';
        }); 
</script>

  </header>

<!--
    TAGS
    On error, the error should be explained with a message in a tooltip.
    TODO: Errthang
    TODO: Bug: When several tags exist and first tag is removed, the new fillable tag appears first in the list.
-->
<div class="article-info">
    <div class="tags" id="tags"></div>
</div>
<script>
// don't navigate away from the field on tab when selecting an item in dropdown (jQuery UI)
$("#taglist").bind( "keydown", function( event ) {
    if ( event.keyCode === $.ui.keyCode.TAB ) {
        event.preventDefault();
    }
    if ( event.keyCode === $.ui.keyCode.ENTER ) {
        var elem = $("#taglist");
        elem.text("," + elem.html().trim());
        event.preventDefault();
    }
});
</script>

<!-- MAIN TEXT -->
  <section class="g-body content-container">
    <div id="main" style="position:relative">
      <div class="toolbar" style="display:block" style="z-index:3000">
        <button data-command-name="bold" data-toggle="tooltip" data-placement="left" title="Bold"><span class="glyphicon glyphicon-bold"></span></button>
        <button data-command-name="italic" data-toggle="tooltip" data-placement="left" title="Italic"><span class="glyphicon glyphicon-italic"></span></button>
        <button data-command-name="h1" data-toggle="tooltip" data-placement="left" title="Big heading"><span class="glyphicon glyphicon-header"></span></button>
        <button data-command-name="h2" data-toggle="tooltip" data-placement="left" title="Small heading"><span class="glyphicon glyphicon-header" style="font-size: 0.8em"></span></button>
        <button data-command-name="blockquote" data-toggle="tooltip" data-placement="left" title="Quotation" style="font-size: 1.3em;">&ldquo;</button>
        <button data-command-name="linkPrompt" data-toggle="tooltip" data-placement="left" title="Link"><span class="glyphicon glyphicon-link"></span></button>
        <button data-command-name="insertUnorderedList" data-toggle="tooltip" data-placement="left" title="Insert unordered list"><span class="glyphicon glyphicon-list"></span></button>
        <button data-command-name="addImage" data-toggle="tooltip" data-placement="left" title="Insert image"><span class="glyphicon glyphicon-picture"></span></button>
      </div>
      <script>
        $(".toolbar button").tooltip("hide");
      </script>

      <article id="content" class="content edit-field empty">
      </article>

    </div>
    <script>

      require(["tt_editor"],function(tt_editor){

          var scribeElement = document.querySelector('.content');
          var toolbarElement = document.querySelector('.toolbar');
          var mediabarElement = document.getElementById('media-bar');

          function addImage(event,element){
            var image = document.getElementById("an-image");
            element.parentNode.insertBefore(image,element);
          }

          var tte = new tt_editor(scribeElement,toolbarElement,mediabarElement,addImage);
          console.log(tte);

      });
    </script>
</section>
<!-- END MAIN TEXT -->

<!-- PAGE-SPECIFIC JS INCLUDES -->
<script data-turbolinks-track="true" src="assets/hiddenform.edit.js?body=1"></script>
<!--MODIFIED--><script data-turbolinks-track="true" src="assets/edit-field.js?body=1"></script>
<!--MODIFIED--><script data-turbolinks-track="true" src="assets/edit-tags.js?body=1"></script>
<!--MODIFIED--><script data-turbolinks-track="true" src="assets/edit-save-publish.js?body=1"></script>
<script data-turbolinks-track="true" src="assets/edit-article.js?body=1"></script>
<script data-turbolinks-track="true" src="assets/edit-price.js?body=1"></script>
<!-- TODO: Why is groups used here!? -->
<script data-turbolinks-track="true" src="assets/groups.js?body=1"></script>


<!-- TOS PROMPTER -->
  <script data-turbolinks-track="true" src="assets/tos.js?body=1"></script>
  <script>
      var vars = {
          post: "14",
          viewer: "5"
      };

      (function($) {
          $(document).ready(function() {
              var post = vars.post,
                  reader = vars.viewer;

              // Present writer with a "redirect-to-TOS" modal if we're not
              // currently editing the TOS and he has yet to accept the tos
              loadRedirectIf(post,reader,function(){ loadRedirect(post,reader);});
          });
      })(jQuery);
  </script>

<!-- DEPRECATED IMAGE INSERTION -->
<div class="add-content-box">
    <form accept-charset="UTF-8" action="/post/attach" class="media_form" enctype="multipart/form-data" id="imgform" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" />    <input name="authenticity_token" type="hidden" value="sgPUtwEkxRl6LiqzHEwZg5PStTtkvloYdLcxK+sAG5k=" /></div>
      <input id="post_media" name="post[media]" type="file" />
      <input id="post_type" name="post[type]" type="hidden" value="image" />
      <input id="post_prodid" name="post[prodid]" type="hidden" value="14" />
      <button class="trigger" id="imgbutton" name="button" type="submit">insert Image</button>
      <input name="commit" type="submit" value="Update Post" />
    </form>
</div>

<!--
    SETTINGS MODAL
    TODO: Errthang
-->
<div class="modal fade settings-modal" id="settings-modal" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">Settings</h4>
            </div>
            <div class="modal-body">
                <form action="http://demo.trunktrunk.org/posts/14" class="button_to" method="post"><div><input name="_method" type="hidden" value="delete" /><input class="btn btn-default" type="submit" value="Delete" /><input name="authenticity_token" type="hidden" value="sgPUtwEkxRl6LiqzHEwZg5PStTtkvloYdLcxK+sAG5k=" /></div></form>
                <button class="btn btn-default" id="unpublish-button">Unpublish</button>
                <button class="btn btn-primary" id="discard-changes-button">Discard changes since last publish</button>
                <div class="price-box input-group">
                  <input type="number" class="form-control edit-field" id="price" style="width: 90px;" step="0.01" min=0 value="0.0">
                </div>
                <button class="btn btn-primary" id="update-price-button">Update price</button>
            </div>
        </div>
    </div>
</div>
     
<!--
    PUBLISH MODAL
    TODO: Should indicate that price is in USD
    TODO: Make submission work
    TODO: Submission should prompt user: "Your article has been published. <View published article>"
-->
<div class="modal fade publish-modal" id="publish-modal" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">Publish article</h4>
            </div>
            <div class="modal-body">
                <p>Do you want to charge money for your article?</p>
                <div class="form-group" style="text-align: center;">
                    <div class="input-group" style="display: inline-block; text-align: left;">
                        <input type="number" class="form-control edit-field" id="price" style="width: 100px;" step="0.01" min=0 value="0.0">
                    </div>
                </div>
                <p>You can change the price later, via the article's Settings menu.</p>
                <button class="btn btn-block btn-lg btn-success" id="confirm-publish">Publish</button>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function() {
        $("#confirm-publish").click(function() {
            $("#publish-modal").modal("hide");
            $("#post-publish-modal").modal("show");
        });
    });
</script>
     
<!--
    POST-PUBLISH MODAL
    TODO: Errthang
-->
<div class="modal fade post-publish-modal" id="post-publish-modal" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">Your article has been published!</h4>
            </div>
            <div class="modal-body">
                <button class="btn btn-block btn-lg btn-primary">View published article</button>
            </div>
        </div>
    </div>
</div>

<!-- SET UP SAVE AND PUBLISH -->
<form accept-charset="UTF-8" action="http://demo.trunktrunk.org/posts/14" data-remote="true" id="post-form" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="_method" type="hidden" value="patch" /></div>
</form>
<script>
    (function($) {
        $(document).ready(function() {
            setUpSaveAndPublish({
                discard_link: "http://demo.trunktrunk.org/posts/14/unpublished_revisions",
                is_published: false
            });
        });
    })(jQuery);
</script>

<!---- END EDITOR ---->


</article>

      <footer class="site-footer"><div class="wrap">
    <span class="copyright">All rights reserved &copy; TrunkTrunk.com</span>
    <span class="to-top"><a href="#top" class="to-top-link">Back to top</a></span>
    <span><a href="http://demo.trunktrunk.org/tos">Terms of Service</a></span>
    <!--span><a href="#NoPrivacyAllowed">Privacy Policy</a></span-->
    <span><a target="_blank" href="mailto:support@trunktrunk.org">Contact</a></span>
    <!--span><a href="#AboutWhat?">About</a></span-->
</div></footer>

    </body>
</html>
